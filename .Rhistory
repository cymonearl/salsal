new_data |>
drop_na()
new_data |>
tolower(product)
new_data |>
tolower(new_data, product)
new_data |>
mutate(
product = tolower(product)
)
new_data |>
mutate(
product = tolower(product)
)
new_data <- new_data |>
mutate(
product = tolower(product)
)
new_data <- new_data |>
drop_na()
new_data
dates <- new_data |>
select(date) |>
dates <- new_data |>
mutate(year = lubridate::year(date),
month = lubridate::month(date, label = TRUE),
day_of_week = lubridate::wday(date, label = TRUE))
dates <- new_data |>
mutate(year = lubridate::year(date),
month = lubridate::month(date, label = TRUE),
day_of_week = lubridate::wday(date, label = TRUE))
dates
data <- read_csv()
data <- read_csv(open.srcfile())
data <- read_csv(file.choose())
data <- read_csv(choose.files())
summary(data)
glimpse(data)
total <- data |>
filter(price > 100)
select <- data |>
select(transaction_id, customer_id, total)
print(select)
print(select)
select <- select |>
distinct()
print(select)
dates <- new_data |>
select(date)
print(dates)
source("~/.active-rstudio-document", echo=TRUE)
print(new_data)
dates <- new_data |>
mutate(year = lubridate::year(date),
month = lubridate::month(date, label = TRUE),
day_of_week = lubridate::wday(date, label = TRUE))
print(new_data)
write_csv(new_data, "cleaned_data.csv")
print(new_data)
print(new_data)
dates <- new_data |>
mutate(year = lubridate::year(date),
month = lubridate::month(date, label = TRUE),
day_of_week = lubridate::wday(date, label = TRUE))
print(new_data)
new_data <- new_data |>
drop_na()
print(new_data)
new_data <- new_data |>
mutate(
product = tolower(product)
)
print(new_data)
dates <- new_data |>
mutate(year = lubridate::year(date),
month = lubridate::month(date, label = TRUE),
day_of_week = lubridate::wday(date, label = TRUE))
print(new_data)
print(dates)
ggplot(new_data, aes(y = total))
boxplot()
ggplot(new_data, aes(y = total)) +
boxplot()
ggplot(new_data, aes(y = total)) +
geom_boxplot()
q1 <- quantile(new_data$total, 0.25, na.rm = TRUE)
q3 <- quantile(new_data$total, 0.75, na.rm = TRUE)
iqr <- q3 - q1
n_data <- new_data |>
filter(total >= (q1 - 1.5 * iqr) & total <= (q3 - 1.5 * iqr))
print(n_data)
q1 <- quantile(new_data$total, 0.25, na.rm = TRUE)
q3 <- quantile(new_data$total, 0.75, na.rm = TRUE)
iqr <- q3 - q1
n_data <- new_data |>
filter(total >= (q1 - 1.5 * iqr) & total <= (q3 - 1.5 * iqr))
print(n_data)
print(new_data)
q1 <- quantile(new_data$discount, 0.25, na.rm = TRUE)
q3 <- quantile(new_data$discount, 0.75, na.rm = TRUE)
iqr <- q3 - q1
n_data <- new_data |>
filter(total >= (q1 - 1.5 * iqr) & total <= (q3 - 1.5 * iqr))
print(n_data)
r_data <- new_data |>
mutate(revenue = quantity * price - discount)
print(r_data)
q_data <- new_data |>
filter(total >= (q1 - 1.5 * iqr) & total <= (q3 - 1.5 * iqr))
print(n_data)
new_data <- new_data |>
mutate(revenue = quantity * price - discount)
print(r_data)
new_data <- new_data |>dates <- new_data |>IQR()
mutate(year = lubridate::year(date),
month = lubridate::month(date, label = TRUE),
day_of_week = lubridate::wday(date, label = TRUE))
new_data <- new_data |>
mutate(year = lubridate::year(date),
month = lubridate::month(date, label = TRUE),
day_of_week = lubridate::wday(date, label = TRUE))
print(dates)
write_csv(new_data, "cleaned_data.csv")
view(new)data
view(new_data)
glimpse(new_data)
?args
formals?
as
?formals
?args
?local
?function
a''
??function
asdf
a
s
?f
?function
sa
?function()
as
?return
?=
?<-
return(final)
this <- function(one, two) {
final <- one + two
return(final)
}
this(1,2)
library(shiny); runApp('Programs/R/Penguin Shiny.R')
package("tidemodels")
package("tidymodels")
package("tidymodel")
library(shiny); runApp('Programs/R/Penguin Shiny.R')
library(shiny)
library(tidymodels)
library(tidyverse)
ui <- fluidPage(
# Application title
titlePanel("Predicting Penguin Species"),
sidebarLayout(
sidebarPanel(
sliderInput("bill_length",
"bill length (mm)",
min = 32.1,
max = 59.6,
value = 45),
sliderInput("bill_depth",
"bill depth (mm)",
min = 13.1,
max = 21.5,
value = 18),
sliderInput("flipper_length",
"flipper length (mm)",
min = 172,
max = 231,
value = 196),
sliderInput("body_mass",
"body mass (g)",
min = 2700,
max = 6300,
value = 5400),
),
mainPanel(
tableOutput("prediction"),
h1(tableOutput("value"))
)
)
)
server <- function(input, output) {
datainput <- reactive({
penguins <- data.frame(
input$bill_length,
input$bill_depth,
input$flipper_length,
input$body_mass
)
colnames(penguins) <- c(
"bill_length_mm",
"bill_depth_mm",
"flipper_length_mm",
"body_mass_g"
)
as_tibble(penguins)
})
predict <- reactive({
ldamodel <- readRDS("./model.rds")
predicted <- augment(ldamodel, datainput())
predicted
})
output$prediction <- renderTable({
predict() |>
select(-bill_length_mm,
-bill_depth_mm,
-flipper_length_mm,
-body_mass_g,
-.pred_class)
})
output$value <- renderTable({
predict() |>
select(.pred_class)
})
}
# Run the application
shinyApp(ui = ui, server = server)
runApp('Programs/R/Penguin Shiny.R')
gc()
library(tidyverse)
library(readxl)
PHILIPPINES <- read_excel("farmgate.xlsx", sheet = 1)
setwd("~/Programs/Second_Year/2nd SEM/ANALYTICS")
PHILIPPINES <- read_excel("farmgate.xlsx", sheet = 1)
ILICOS_REGION <- read_excel("farmgate.xlsx", sheet = 2)
CAR <- read_excel("farmgate.xlsx", sheet = 3)
CAGAYAN_VALLEY <- read_excel("farmgate.xlsx", sheet = 4)
CENTRAL_LUZON <- read_excel("farmgate.xlsx", sheet = 5)
CALABARZON <- read_excel("farmgate.xlsx", sheet = 6)
MIMAROPA <- read_excel("farmgate.xlsx", sheet = 7)
BICOL_REGION <- read_excel("farmgate.xlsx", sheet = 8)
WESTERN_VISAYAS <- read_excel("farmgate.xlsx", sheet = 9)
CENTRAL_VISAYAS <- read_excel("farmgate.xlsx", sheet = 10)
EASTERN_VISAYAS <- read_excel("farmgate.xlsx", sheet = 11)
NORTHERN_MINDANAO <- read_excel("farmgate.xlsx", sheet = 12)
ZOMBOANGA_PENINSULA <- read_excel("farmgate.xlsx", sheet = 13)
DAVAO_REGION <- read_excel("farmgate.xlsx", sheet = 14)
SOCCKSARGEN <- read_excel("farmgate.xlsx", sheet = 15)
CARAGA <- read_excel("farmgate.xlsx", sheet = 16)
BARMM <- read_excel("farmgate.xlsx", sheet = 17)
SOUTHERN_TAGALOG <- read_excel("farmgate.xlsx", sheet = 18)
METRO_MANILA <- read_excel("farmgate.xlsx", sheet = 19)
View(data)
View(PHILIPPINES)
View(PHILIPPINES)
glimpse(PHILIPPINES)
glimpse(CAR)
philippines_long <- PHILIPPINES %>%
mutate(Region = "PHILIPPINES") %>%
pivot_longer(cols = -c(Year, Region),
names_to = "Price_Type",
values_to = "Price")
View(philippines_long)
View(philippines_long)
View(CALABARZON)
combine_multiple_regions <- function(region_data_list) {
library(dplyr)
library(tidyr)
library(purrr)
# Iterate over named list and process each region's dataset
combined_data <- imap_dfr(region_data_list, function(data, region_name) {
data %>%
mutate(Region = region_name) %>%
pivot_longer(
cols = -c(Year, Region),
names_to = "Price_Type",
values_to = "Price"
)
})
return(combined_data)
}
data %>%
mutate(Region = region_name) %>%
pivot_longer(
cols = -c(Year, Region),
names_to = "Price_Type",
values_to = "Price"
)
PHILIPPINES <- read_excel("farmgate.xlsx", sheet = 1)
ILICOS_REGION <- read_excel("farmgate.xlsx", sheet = 2)
CAR <- read_excel("farmgate.xlsx", sheet = 3)
CAGAYAN_VALLEY <- read_excel("farmgate.xlsx", sheet = 4)
CENTRAL_LUZON <- read_excel("farmgate.xlsx", sheet = 5)
CALABARZON <- read_excel("farmgate.xlsx", sheet = 6)
MIMAROPA <- read_excel("farmgate.xlsx", sheet = 7)
BICOL_REGION <- read_excel("farmgate.xlsx", sheet = 8)
WESTERN_VISAYAS <- read_excel("farmgate.xlsx", sheet = 9)
CENTRAL_VISAYAS <- read_excel("farmgate.xlsx", sheet = 10)
EASTERN_VISAYAS <- read_excel("farmgate.xlsx", sheet = 11)
NORTHERN_MINDANAO <- read_excel("farmgate.xlsx", sheet = 12)
ZOMBOANGA_PENINSULA <- read_excel("farmgate.xlsx", sheet = 13)
DAVAO_REGION <- read_excel("farmgate.xlsx", sheet = 14)
SOCCKSARGEN <- read_excel("farmgate.xlsx", sheet = 15)
CARAGA <- read_excel("farmgate.xlsx", sheet = 16)
BARMM <- read_excel("farmgate.xlsx", sheet = 17)
SOUTHERN_TAGALOG <- read_excel("farmgate.xlsx", sheet = 18)
glimpse(ILOCOS_REGION)
ILOCOS_REGION <- read_excel("farmgate.xlsx", sheet = 2)
glimpse(ILOCOS_REGION)
glimpse(PHILIPPINES)
glimpse(CAR)
glimpse(ILOCOS_REGION)
View(philippines_long)
View(philippines_long)
require(dplyr)
pivot_rice_prices <- function(data_frame) {
require(tidyr)
require(dplyr)
# Pivot longer to transform the data
result <- data_frame %>%
pivot_longer(
cols = c("FARMGATE (PhP/kg)", "WHOLESALE (PhP/kg)", "RETAIL (PhP/kg)"),
names_to = "Price_Type",
values_to = "Price"
) %>%
# Clean up the Price_Type column by removing the unit part
mutate(Price_Type = gsub(" \\(PhP/kg\\)", "", Price_Type))
return(result)
}
pivot_ph <- pivot_rice_prices(PHILIPPINES)
pivot_ph
pivot_and_combine_rice_prices <- function(data_frames_list, region_names) {
require(tidyr)
require(dplyr)
require(purrr)
# Check if the lengths of inputs match
if(length(data_frames_list) != length(region_names)) {
stop("The number of data frames must match the number of region names")
}
# Map through each data frame and its corresponding region name
combined_data <- map2_dfr(data_frames_list, region_names, function(df, region) {
df %>%
mutate(Region = region) %>%
pivot_longer(
cols = -c(Year, Region),
names_to = "Price_Type",
values_to = "Price"
)
})
return(combined_data)
}
PHILIPPINES <- read_excel("farmgate.xlsx", sheet = 1)
ILOCOS_REGION <- read_excel("farmgate.xlsx", sheet = 2)
CAR <- read_excel("farmgate.xlsx", sheet = 3)
CAGAYAN_VALLEY <- read_excel("farmgate.xlsx", sheet = 4)
CENTRAL_LUZON <- read_excel("farmgate.xlsx", sheet = 5)
CALABARZON <- read_excel("farmgate.xlsx", sheet = 6)
MIMAROPA <- read_excel("farmgate.xlsx", sheet = 7)
BICOL_REGION <- read_excel("farmgate.xlsx", sheet = 8)
WESTERN_VISAYAS <- read_excel("farmgate.xlsx", sheet = 9)
CENTRAL_VISAYAS <- read_excel("farmgate.xlsx", sheet = 10)
EASTERN_VISAYAS <- read_excel("farmgate.xlsx", sheet = 11)
NORTHERN_MINDANAO <- read_excel("farmgate.xlsx", sheet = 12)
ZOMBOANGA_PENINSULA <- read_excel("farmgate.xlsx", sheet = 13)
DAVAO_REGION <- read_excel("farmgate.xlsx", sheet = 14)
SOCCKSARGEN <- read_excel("farmgate.xlsx", sheet = 15)
CARAGA <- read_excel("farmgate.xlsx", sheet = 16)
BARMM <- read_excel("farmgate.xlsx", sheet = 17)
SOUTHERN_TAGALOG <- read_excel("farmgate.xlsx", sheet = 18)
METRO_MANILA <- read_excel("farmgate.xlsx", sheet = 19)
region_data <- pivot_and_combine_rice_prices(
list(BARMM, BICOL_REGION, CAGAYAN_VALLEY, CALABARZON, CAR, CARAGA, CENTRAL_LUZON,
CENTRAL_VISAYAS, DAVAO_REGION, EASTERN_VISAYAS, ILOCOS_REGION, METRO_MANILA, MIMAROPA,
NORTHERN_MINDANAO, SOCCKSARGEN, SOUTHERN_TAGALOG, WESTERN_VISAYAS, ZOMBOANGA_PENINSULA),
c("BARMM","BICOL_REGION","CAGAYAN_VALLEY","CALABARZON","CAR","CARAGA","CENTRAL_LUZON",
"CENTRAL_VISAYAS","DAVAO_REGION", "EASTERN_VISAYAS", "ILOCOS_REGION","METRO_MANILA","MIMAROPA",
"NORTHERN_MINDANAO","SOCCKSARGEN", "SOUTHERN_TAGALOG", "WESTERN_VISAYAS", "ZAMBOANGA_PENINSULA")
)
VIEW(DAVAO_REGION)
Viev(DAVAO_REGION)
View(DAVAO_REGION)
rlang::last_trace()
all_regions_data <- pivot_and_combine_rice_prices(
list(PHILIPPINES, CAR, ILOCOS_REGION),
c("PHILIPPINES", "CAR", "ILOCOS REGION")
)
all_regions_data
View(all_regions_data)
all_regions_data <- pivot_and_combine_rice_prices(
list(PHILIPPINES, CAR, ILOCOS_REGION, CAGAYAN_VALLEY),
c("PHILIPPINES", "CAR", "ILOCOS REGION", "CAGAYAN_VALLEY")
)
region_data <- pivot_and_combine_rice_prices(
list(BARMM, BICOL_REGION, CAGAYAN_VALLEY, CALABARZON, CAR, CARAGA, CENTRAL_LUZON,
CENTRAL_VISAYAS, DAVAO_REGION, EASTERN_VISAYAS, ILOCOS_REGION, METRO_MANILA, MIMAROPA,
NORTHERN_MINDANAO, SOCCKSARGEN, SOUTHERN_TAGALOG, WESTERN_VISAYAS, ZOMBOANGA_PENINSULA),
c("BARMM","BICOL_REGION","CAGAYAN_VALLEY","CALABARZON","CAR","CARAGA","CENTRAL_LUZON",
"CENTRAL_VISAYAS","DAVAO_REGION", "EASTERN_VISAYAS", "ILOCOS_REGION","METRO_MANILA","MIMAROPA",
"NORTHERN_MINDANAO","SOCCKSARGEN", "SOUTHERN_TAGALOG", "WESTERN_VISAYAS", "ZAMBOANGA_PENINSULA")
)
region_data <- pivot_and_combine_rice_prices(
list(BARMM, BICOL_REGION, CAGAYAN_VALLEY, CALABARZON, CAR, CARAGA, CENTRAL_LUZON),
c("BARMM","BICOL_REGION","CAGAYAN_VALLEY","CALABARZON","CAR","CARAGA","CENTRAL_LUZON")
)
glimpse(BARMM)
region_data <- pivot_and_combine_rice_prices(
list(BARMM, BICOL_REGION, CAGAYAN_VALLEY),
c("BARMM","BICOL_REGION","CAGAYAN_VALLEY")
)
region_data <- pivot_and_combine_rice_prices(
list(BARMM, BICOL_REGION, CAGAYAN_VALLEY),
c("BARMM","BICOL_REGION","CAGAYAN_VALLEY")
)
glimpse(CAGAYAN_VALLEY)
glimpse(BICOL_REGION)
glimpse(CAGAYAN_VALLEY)
PHILIPPINES <- read_excel("farmgate.xlsx", sheet = 1)
ILOCOS_REGION <- read_excel("farmgate.xlsx", sheet = 2)
CAR <- read_excel("farmgate.xlsx", sheet = 3)
CAGAYAN_VALLEY <- read_excel("farmgate.xlsx", sheet = 4)
CENTRAL_LUZON <- read_excel("farmgate.xlsx", sheet = 5)
CALABARZON <- read_excel("farmgate.xlsx", sheet = 6)
MIMAROPA <- read_excel("farmgate.xlsx", sheet = 7)
BICOL_REGION <- read_excel("farmgate.xlsx", sheet = 8)
WESTERN_VISAYAS <- read_excel("farmgate.xlsx", sheet = 9)
CENTRAL_VISAYAS <- read_excel("farmgate.xlsx", sheet = 10)
EASTERN_VISAYAS <- read_excel("farmgate.xlsx", sheet = 11)
NORTHERN_MINDANAO <- read_excel("farmgate.xlsx", sheet = 12)
ZOMBOANGA_PENINSULA <- read_excel("farmgate.xlsx", sheet = 13)
DAVAO_REGION <- read_excel("farmgate.xlsx", sheet = 14)
SOCCKSARGEN <- read_excel("farmgate.xlsx", sheet = 15)
CARAGA <- read_excel("farmgate.xlsx", sheet = 16)
BARMM <- read_excel("farmgate.xlsx", sheet = 17)
SOUTHERN_TAGALOG <- read_excel("farmgate.xlsx", sheet = 18)
METRO_MANILA <- read_excel("farmgate.xlsx", sheet = 19)
glimpse(PHILIPPINES)
glimpse(BICOL_REGION)
glimpse(CAGAYAN_VALLEY)
ZAMBOANGA_PENINSULA <- read_excel("farmgate.xlsx", sheet = 13)
glimpse(PHILIPPINES)
glimpse(ILOCOS_REGION)
glimpse(CAR)
glimpse(CAGAYAN_VALLEY)
glimpse(CENTRAL_LUZON)
glimpse(CALABARZON)
glimpse(MIMAROPA)
glimpse(BICOL_REGION)
glimpse(WESTERN_VISAYAS)
glimpse(CENTRAL_LUZON)
glimpse(EASTERN_VISAYAS)
glimpse(NORTHERN_MINDANAO)
glimpse(ZAMBOANGA_PENINSULA)
glimpse(DAVAO_REGION)
glimpse(SOCCKSARGEN)
glimpse(CARAGA)
glimpse(BARMM)
glimpse(SOUTHERN_TAGALOG)
glimpse(METRO_MANILA)
glimpse(CENTRAL_LUZON)
PHILIPPINES <- read_excel("farmgate.xlsx", sheet = 1)
ILOCOS_REGION <- read_excel("farmgate.xlsx", sheet = 2)
CAR <- read_excel("farmgate.xlsx", sheet = 3)
CAGAYAN_VALLEY <- read_excel("farmgate.xlsx", sheet = 4)
CENTRAL_LUZON <- read_excel("farmgate.xlsx", sheet = 5)
CALABARZON <- read_excel("farmgate.xlsx", sheet = 6)
MIMAROPA <- read_excel("farmgate.xlsx", sheet = 7)
BICOL_REGION <- read_excel("farmgate.xlsx", sheet = 8)
WESTERN_VISAYAS <- read_excel("farmgate.xlsx", sheet = 9)
CENTRAL_VISAYAS <- read_excel("farmgate.xlsx", sheet = 10)
EASTERN_VISAYAS <- read_excel("farmgate.xlsx", sheet = 11)
NORTHERN_MINDANAO <- read_excel("farmgate.xlsx", sheet = 12)
ZAMBOANGA_PENINSULA <- read_excel("farmgate.xlsx", sheet = 13)
DAVAO_REGION <- read_excel("farmgate.xlsx", sheet = 14)
SOCCKSARGEN <- read_excel("farmgate.xlsx", sheet = 15)
CARAGA <- read_excel("farmgate.xlsx", sheet = 16)
BARMM <- read_excel("farmgate.xlsx", sheet = 17)
SOUTHERN_TAGALOG <- read_excel("farmgate.xlsx", sheet = 18)
METRO_MANILA <- read_excel("farmgate.xlsx", sheet = 19)
glimpse(PHILIPPINES)
glimpse(ILOCOS_REGION)
glimpse(CAR)
glimpse(CAGAYAN_VALLEY)
glimpse(CENTRAL_LUZON)
glimpse(CALABARZON)
glimpse(MIMAROPA)
glimpse(BICOL_REGION)
glimpse(WESTERN_VISAYAS)
glimpse(CENTRAL_LUZON)
glimpse(EASTERN_VISAYAS)
glimpse(NORTHERN_MINDANAO)
glimpse(ZAMBOANGA_PENINSULA)
glimpse(DAVAO_REGION)
glimpse(SOCCKSARGEN)
glimpse(CARAGA)
glimpse(BARMM)
glimpse(SOUTHERN_TAGALOG)
glimpse(METRO_MANILA)
glimpse(CENTRAL_LUZON)
region_data <- pivot_and_combine_rice_prices(
list(BARMM, BICOL_REGION, CAGAYAN_VALLEY, CALABARZON, CAR, CARAGA, CENTRAL_LUZON,
CENTRAL_VISAYAS, DAVAO_REGION, EASTERN_VISAYAS, ILOCOS_REGION, METRO_MANILA, MIMAROPA,
NORTHERN_MINDANAO, SOCCKSARGEN, SOUTHERN_TAGALOG, WESTERN_VISAYAS, ZOMBOANGA_PENINSULA),
c("BARMM","BICOL_REGION","CAGAYAN_VALLEY","CALABARZON","CAR","CARAGA","CENTRAL_LUZON",
"CENTRAL_VISAYAS","DAVAO_REGION", "EASTERN_VISAYAS", "ILOCOS_REGION","METRO_MANILA","MIMAROPA",
"NORTHERN_MINDANAO","SOCCKSARGEN", "SOUTHERN_TAGALOG", "WESTERN_VISAYAS", "ZAMBOANGA_PENINSULA")
)
sum(is.na(region_data))
duplicated(region_data)
sum(duplicated(region_data))
sum(is.na(region_data))
sum(duplicated(region_data))
